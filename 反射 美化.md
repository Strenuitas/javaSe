# Java 反射

反射主要分为两部分：

- **获取**：获取到类里面所有的字段、构造方法和成员方法  
- **解剖**：获取成员变量的修饰符、数据类型、变量名（方法也是如此）

---

## 获取 —— 从字节码文件里面去获取

先获取 **class 字节码文件对象**，再从中获取构造方法、字段或方法。  
Java 中万物皆对象：

- 字节码文件当做 **Class** 这个类的对象  
- 构造方法当做 **Constructor** 这个类的对象  
- 字段（成员变量）当做 **Field** 这个类的对象  
- 方法当做 **Method** 这个类的对象  

---

## 示例：获取构造方法

假如有个类 `Person` 构造方法如下：
```java
public Person(String s) {}

import java.lang.reflect.Constructor;
import java.lang.reflect.Field;

class Person {
    private String name;
    private int age;

    // 构造方法
    public Person(String name) {
        this.name = name;
        this.age = 18;
    }

    @Override
    public String toString() {
        return "Person{name='" + name + "', age=" + age + "}";
    }
}

public class ReflectDemo {
    public static void main(String[] args) throws Exception {
        // 1. 获取字节码文件对象
        Class<?> clazz = Class.forName("Person");

        // 2. 获取构造方法并创建对象
        Constructor<?> con = clazz.getConstructor(String.class);
        Object obj = con.newInstance("王二");
        System.out.println("创建的对象：" + obj);

        // 3. 获取字段
        Field nameField = clazz.getDeclaredField("name");
        Field ageField = clazz.getDeclaredField("age");

        // 4. 取消私有访问检查
        nameField.setAccessible(true);
        ageField.setAccessible(true);

        // 5. 获取字段值
        System.out.println("原始 name：" + nameField.get(obj)); // 王二
        System.out.println("原始 age：" + ageField.get(obj));   // 18

        // 6. 修改字段值
        nameField.set(obj, "李四");
        ageField.set(obj, 25);

        // 7. 再次打印对象
        System.out.println("修改后的对象：" + obj);
    }
}

创建的对象：Person{name='王二', age=18}
原始 name：王二
原始 age：18
修改后的对象：Person{name='李四', age=25}

